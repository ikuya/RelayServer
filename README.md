
# Relay Server

## 起動

start.bat でMongoDBとサーバーアプリが起動します。

MondoDBのデータファイルとログファイルのパスは、deploy.bat内で指定しています。既定値は以下。

  * データファイル: data/db 以下
  * ログファイル: data/log
  
## 設定ファイル

config.json で以下の項目を設定することができます。

  * port
      * HTTPサーバのポート番号。
      * Androidからサーバーへの写真送信はHTTPのPOSTを使用するため、Android側でもこのポート番号を設定してください。
  * websocket_port
      * プロジェクタ側アプリとの通信に用いるWebSocket用のポート番号

  * db
      * サーバーで用いるMongoDBのDB名
      * テスト用に導入した設定項目ですが、「サーバー内に写真データを保持したまま、写真履歴画面をまっさらな状態からスタートしたい」といったときは、このDB名を変更してから起動するのが手っ取り早い方法です。

設定ファイルの読み込みに失敗した場合は以下の値が既定値として使用されます。

  * port: 3000
  * websocket_port: 3001
  * db: images

## 写真履歴

http://hostname:port/ (またはページ上部メニューバーの「Photos」)にアクセスすると、Androidから送信された写真一覧が表示されます。

  * 「Send」ボタン: 写真がプロジェクタ側アプリに送信されます。
  * 「Delete」ボタン: 写真が削除されます。
  * 新たに写真を受信すると「PHOTOS」の題字が赤くなります。ページへの自動追加はされないので手動でリロードしてください。
  * 送信された写真の実体は public/images フォルダに保存されます。

## プロジェクタ情報の監視

http://hostname:port/status/ (またはページ上部メニューバーの「Information」)にアクセスすると、サーバーにWebSocketで接続されているプロジェクタからのステータス情報が表示されます。

  * 「Refresh」ボタン: プロジェクタから送信されたスクリーンショット画像の表示を手動で更新します。
